[defaults] 
remote_user = ubuntu
remote_tmp = /tmp/.ansible
local_tmp = /tmp/.ansible

# [defaults]
# # ----------------------------------------------------------------------
# # Connection & Paths
# # ----------------------------------------------------------------------
# # FIX: Remove 'remote_user = ubuntu'.
# # AWS SSM connects as 'ssm-user' by default. Hardcoding 'ubuntu' causes
# # permission errors because ssm-user cannot write to /home/ubuntu/.ansible.
# # We let the connection plugin dictate the user.

# # Use the connecting user's home directory (e.g., /home/ssm-user/.ansible/tmp).
# remote_tmp     = ~/.ansible/tmp
# local_tmp      = ~/.ansible/tmp

# ----------------------------------------------------------------------
# Behavior & Output
# ----------------------------------------------------------------------
# Disable host key checking for dynamic/cloud environments.
host_key_checking = False

# Suppress deprecation warnings to keep logs clean.
deprecation_warnings = False

# Use auto-silent interpreter discovery.
interpreter_python = auto_silent

# ----------------------------------------------------------------------
# Performance Tuning
# ----------------------------------------------------------------------
forks = 10

[ssh_connection]
pipelining = True
ssh_args = -o ControlMaster=auto -o ControlPersist=60s